# Stain-detection-in-fabrics
# This is a MATLAB code for stain detection in fabrics
Firstly read the image of the fabric which containsthe stain.
Then convert the rbg(red blue green) image into grey scale image. If its already in grey scale then no need to convert into grey scale.
Next step is to perform image enhancement by thresholding technques.Histogram equalization method is adopted to enhance the contrast of the fabric surface.Histogram Equalization algorithm works good in this case as the fabric texture.Then perform defect identification and texture analysis using K-Means clustering.
K-Means Clustering:
We have to specify the number of clusters
We want the data to be grouped into. The algorithm randomly assigns each observation to a cluster, and finds the centroid of each cluster. The algorithm iterates over following steps:
•Compute the mean of each cluster.
•Compute the distance of each point from each cluster by computing its distance from the corresponding cluster mean. Assign each point to the cluster it is nearest to.
•Iterate over the above two steps till the sum of squared within group errors cannot be lowered any more.
The initial assignment of points to clusters can be done randomly. In the course of the iterations, the algorithm tries to minimize the sum, over all groups, of the squared within group errors, which are the distances of the points to the respective group means. Convergence is reached when the objective function (i.e., the residual sum-of-squares) cannot be lowered any more. The groups obtained are such that they are geometrically as compact as possible around their respective means. Using the set of feature images, a feature vector is constructed corresponding to each pixel (e(a,b) ,e2(a,b) …..en(a,b) ) where d is the number of feature images used for the segmentation process. The KMeans can then be used to segment the image into three clusters - corresponding to two scripts and background respectively. For each additional script, one more cluster is added. Here, each feature is assigned a different weight, which is calculated based on the feature importance as described in the previous Section. The distance between two vectors is computed. Once the image has been segmented using the K-Means algorithm, the clustering can be improved by assuming that neighbouring pixels have a high probability of falling into the same cluster. Thus, even if a pixel has been wrongly clustered, it can be corrected by looking at the neighbouring pixels.
